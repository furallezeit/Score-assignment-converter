# 浙江省学生科目赋分转换系统
Score-assignment-converter  
适用于浙江省师生的科目赋分转换工具，支持上传原始分数表和赋分规则表，自动完成赋分计算并生成结果文件。

> 英文版本：[README_EN.md](README_EN.md)

## 一、系统介绍
### 功能特点
- 支持Excel（.xlsx）和CSV（.csv）格式的原始分数表、赋分规则表上传
- 自动计算每个学生各科目的赋分值，并统计赋分总分
- 可自定义赋分列插入位置（科目后/表格末尾）
- 生成唯一命名的结果文件，避免重复覆盖
- 友好的Web界面，操作简单直观
- 提供测试数据生成工具，快速验证功能

### 技术栈
- 后端：Python + Flask
- 数据处理：Pandas
- 前端：HTML + CSS
- 依赖库：openpyxl（Excel处理）、Faker（测试数据生成）

## 二、环境准备
### 1. 安装Python环境
确保安装Python 3.7及以上版本，推荐3.8-3.10版本。

### 2. 安装依赖包
```bash
pip install flask pandas openpyxl faker
```

## 三、使用说明
### 1. 启动系统
```bash
# 进入项目根目录（赋分程序文件夹）
cd 赋分程序

# 运行Flask应用
python app.py
```
启动后，浏览器访问 `http://localhost:5000` 即可进入系统页面。

### 2. 操作步骤
#### 步骤1：准备表格文件
- **原始分数表**：需包含列名（姓名、物理、化学、生物、政治、历史、地理、技术等），空值直接留空，支持.xlsx/.csv格式。
- **赋分规则表**：第一列固定为「赋分值」，其他列为科目名称（需与原始表一致），每行数值为对应赋分值的最低原始分要求，支持.xlsx/.csv格式。

#### 步骤2：上传文件并配置
1. 在系统页面上传「原始分数表」和「赋分规则表」
2. 选择赋分列插入位置：
   - 插入到对应科目列后方：每科赋分列紧跟该科目原始列后
   - 追加到表格末尾：所有赋分列统一放在表格最后
3. 点击「开始赋分并生成文件」按钮

#### 步骤3：下载结果文件
系统自动计算赋分并生成下载文件，文件名格式为：`赋分结果表_年月日_时分秒.xlsx`，下载后即可查看：
- 各科原始分对应的赋分值
- 所有有效赋分的总分统计

### 3. 测试数据生成（快速验证）
项目提供测试数据生成工具，可快速生成模拟的原始分数表，用于测试系统功能：
```bash
# 进入testfile目录
cd 赋分程序/testfile

# 运行测试数据生成脚本
python generate_test_data.py
```
#### 生成规则说明
- 随机生成50名学生的信息（中文姓名）
- 每位学生随机选择3门科目生成成绩（覆盖0-100分区间，分差/中/好三个等级）
- 生成的文件名为：`原始分数表_随机字符串.xlsx`（确保唯一性）
- 生成后可将该文件作为「原始分数表」上传，配合自定义的「赋分规则表」测试赋分功能

## 四、表格格式规范
### 1. 原始分数表示例
| 姓名   | 物理  | 化学  | 生物  | 政治 | 历史 | 地理 | 技术 |
|--------|-------|-------|-------|------|------|------|------|
| 张三   | 85.5  |       | 78.2  |      |      |      |      |
| 李四   |       | 62.0  |       | 88.8 |      |      |      |
| 王五   | 45.3  | 56.7  | 90.1  |      |      |      |      |

### 2. 赋分规则表示例
| 赋分值 | 物理 | 化学 | 生物 | 政治 | 历史 | 地理 | 技术 |
|--------|------|------|------|------|------|------|------|
| 100    | 95   | 94   | 96   | 95   | 93   | 94   | 95   |
| 97     | 90   | 89   | 91   | 90   | 88   | 89   | 90   |
| 94     | 85   | 84   | 86   | 85   | 83   | 84   | 85   |
| 91     | 80   | 79   | 81   | 80   | 78   | 79   | 80   |
| ...    | ...  | ...  | ...  | ...  | ...  | ...  | ...  |
| 40     | 0    | 0    | 0    | 0    | 0    | 0    | 0    |

**说明**：赋分规则表中，每行的「赋分值」对应该科目达到「最低原始分」即可获得的赋分，系统会匹配原始分≥最低原始分的最高赋分值。

## 五、常见问题
1. **文件上传失败**：检查文件大小（≤10MB）、格式（仅支持.xlsx/.csv），确保文件未损坏。
2. **赋分计算为空**：确认赋分规则表的科目名称与原始表一致，原始分需为数字格式（避免文本/特殊字符）。
3. **页面无响应**：检查Flask服务是否正常运行，浏览器控制台是否有报错信息。
4. **测试数据生成失败**：确保已安装Faker库（`pip install faker`），Python环境正常。

## 六、目录结构
```
赋分程序/
├── app.py              # Flask应用入口
├── config.py           # 系统配置（密钥、文件限制、路径等）
├── score_processor.py  # 核心赋分计算逻辑
├── utils.py            # 工具函数（生成唯一文件名）
├── README.md           # 项目说明文档（中文）
├── README_EN.md        # 项目说明文档（英文）
├── static/             # 静态资源（CSS）
│   └── css/
│       └── style.css
├── templates/          # 前端模板
│   └── index.html
└── testfile/           # 测试相关
    └── generate_test_data.py  # 测试数据生成脚本
```